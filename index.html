<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>상남자의 웹페이지</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: black;
      color: white;
      text-align: center;
      padding: 20px;
    }
    h1, h2 {
      margin-bottom: 20px;
    }
    button {
      margin: 20px auto;
      padding: 25px 50px;
      font-size: 1.8rem;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background-color: darkred;
      color: white;
      text-align: center;
      display: block;
    }
    button:hover {
      background-color: crimson;
    }
    input {
      display: block;
      width: 80%;
      max-width: 400px;
      margin: 10px auto;
      padding: 15px;
      font-size: 1.2rem;
      border-radius: 5px;
      border: none;
    }
    form {
      margin: 20px auto;
      text-align: center;
      width: 100%;
    }
    textarea {
      display: block;
      width: 80%;
      max-width: 400px;
      margin: 10px auto;
      padding: 15px;
      font-size: 1.2rem;
      border-radius: 5px;
      border: none;
    }
    img {
      display: block;
      max-width: 100%;
      height: auto;
      margin: 20px auto;
    }
    #main-buttons {
      margin: 20px auto;
    }
    .hidden {
      display: none;
    }
    #board {
      margin-top: 20px;
      text-align: center;
      padding: 20px;
      background-color: darkred;
      border-radius: 10px;
      width: 80%;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    #board h2 {
      font-size: 1.5rem;
      color: yellow;
      text-align: center;
    }
    .post {
      background-color: black;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      color: white;
      text-align: center;
    }
    .post span {
      font-size: 0.8rem;
      color: gray;
      text-align: center;
    }
    #game-area {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 400px;
      background-color: darkred;
      position: relative;
      color: yellow;
      font-size: 2rem;
      cursor: pointer;
    }
    #ranking-page ul {
      list-style: none;
      padding: 0;
    }
    #ranking-page li {
      margin: 10px 0;
      font-size: 1.5rem;
      color: gold;
    }
    #food-tournament {
      position: fixed; 
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.9);
      color: white;
      display: none; 
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000; 
    }

    #food-tournament.visible {
      display: flex; 
    }


  </style>
</head>
<body>
  <h1>상남자의 홈페이지</h1>
  <div id="main-buttons">
    <button onclick="showForm('login')">로그인</button>
    <button onclick="showForm('signup')">회원가입</button>
    <img src="image2.png" alt="상남자의 이미지">
    <b style="font-size: 4rem; color: white;">남자는 등으로 말한다</b>
  </div>

  <form id="login-form" class="hidden">
    <h2>로그인</h2>
    <input type="text" id="login-username" placeholder="아이디" required>
    <input type="password" id="login-password" placeholder="비밀번호" required>
    <button type="button" onclick="login()">로그인</button>
    <button type="button" onclick="goBack()">1보 전진을 위한 2보 후퇴</button>
    <img src="image3.png" alt="상남자의 이미지">
  </form>

  <form id="signup-form" class="hidden">
    <h2>회원가입</h2>
    <input type="text" id="signup-username" placeholder="아이디" required>
    <input type="password" id="signup-password" placeholder="비밀번호" required>
    <button type="button" onclick="signup()">회원가입</button>
    <button type="button" onclick="goBack()">1보 전진을 위한 2보 후퇴</button>
    <img src="image3.png" alt="상남자의 이미지">
  </form>

  <div id="welcome" class="hidden">
    <h2>어서와라, 상남자의 홈페이지다!</h2>
    <div id="welcome-buttons">
      <button onclick="goToBoard()">게시판으로</button><br>
      <button onclick="startGame()">상남자력 테스트</button>
      <button onclick="showRanking()">상남자 랭킹</button><br>
      <button onclick="startFoodTournament()">상남자 음식 월드컵</button><br>
      <button onclick="gayTest()">하남자 테스트</button><br>
      <button onclick="logout()">리버스 로그인</button>
    </div>
    <img src="image.png" alt="상남자의 이미지">
  </div>
  

  <div id="board" class="hidden">
    <h2>남아일언중천금</h2>
    <textarea id="post-content" rows="5" placeholder="여기에 글을 작성하라" required></textarea>
    <button type="button" onclick="addPost()">글 올리기</button>
    <div id="posts"></div>
    <button onclick="goBack()">초심불망 마부작침</button>
  </div>

  <div id="food-tournament" class="hidden" style="text-align:center; padding:20px;"></div>

  <script>
    let boardTimer;

    function startBoardTimer() {
      clearTimeout(boardTimer);
      boardTimer = setTimeout(() => {
        alert('시간 초과다. 상남자는 시간을 허투루 쓰지 않는다.');
        window.close();
      }, 50000);
    }

    function goToBoard() {
      document.getElementById('welcome').classList.add('hidden');
      document.getElementById('board').classList.remove('hidden');
      startBoardTimer();
    }

    function addPost() {
      const content = document.getElementById('post-content').value.trim();
        
      if (!content) {
        alert('남자가 칼을 뽑았으면 썩은 무라도 썰어야 하는 법! 무언가를 쓰기 전까지는 이곳에서 글을 올릴 수 없다!');
        return;
      }
    
      let formattedContent = `사나이 ${content} 상남자`;
    
      const words = formattedContent.split(' ');
      const numberOfInsertions = Math.min(3, words.length - 1); 
    
      for (let i = 0; i < numberOfInsertions; i++) {
        const randomIndex = Math.floor(Math.random() * (words.length - 1)) + 1; 
        words.splice(randomIndex, 0, '💪🏻상남자💪🏻');
      }
    
      formattedContent = words.join(' '); 
    
      const post = document.createElement('div');
      post.classList.add('post');
      const timestamp = new Date().toLocaleString();
      post.innerHTML = `<p>${formattedContent}</p><span>${timestamp}</span>`;
      document.getElementById('posts').appendChild(post);
      document.getElementById('post-content').value = ''; 
    }



    function logout() {
      sessionStorage.removeItem('loggedInUser');
      document.getElementById('welcome').classList.add('hidden');
      document.getElementById('board').classList.add('hidden');
      document.getElementById('main-buttons').classList.remove('hidden');
      clearTimeout(boardTimer);
    }

    function showForm(type) {
      document.getElementById('main-buttons').classList.add('hidden');
      if (type === 'login') {
        document.getElementById('login-form').classList.remove('hidden');
      } else if (type === 'signup') {
        document.getElementById('signup-form').classList.remove('hidden');
      }
    }

    function goBack() {
      document.querySelectorAll('form').forEach(form => form.classList.add('hidden'));
      document.getElementById('welcome').classList.add('hidden');
      document.getElementById('board').classList.add('hidden');
      document.getElementById('main-buttons').classList.remove('hidden');
    }


    function signup() {
      const username = document.getElementById('signup-username').value;
      const password = document.getElementById('signup-password').value;

      if (localStorage.getItem(username)) {
        alert('이 아이디는 이미 쓰고 있는 놈이 있다!');
      } else {
        localStorage.setItem(username, password);
        alert('회원가입 완료다!');
        goBack();
      }
    }

    function login() {
      const username = document.getElementById('login-username').value;
      const password = document.getElementById('login-password').value;
        
      const storedPassword = localStorage.getItem(username);
        
      if (storedPassword === password) {
        sessionStorage.setItem('loggedInUser', username);
        document.getElementById('login-form').classList.add('hidden');
        document.getElementById('welcome').classList.remove('hidden');
        updateWelcomeButtons();
      } else {
        alert('아이디나 비밀번호가 틀렸다. 다시 해라.');
      }
    }

    function updateWelcomeButtons() {
      const currentUser = sessionStorage.getItem('loggedInUser');
      const welcomeButtons = document.getElementById('welcome-buttons');

      if (!welcomeButtons) {
        console.error("Element 'welcome-buttons'를 찾을 수 없습니다.");
        return;
      }
    
      const button2 = welcomeButtons.querySelector('button:nth-child(2)');
      const button3 = welcomeButtons.querySelector('button:nth-child(3)');
    
      if (currentUser) {
        if (button2) button2.style.display = 'inline-block';
        if (button3) button3.style.display = 'inline-block';
      } else {
        if (button2) button2.style.display = 'none';
        if (button3) button3.style.display = 'none';
      }
    }


    window.onload = function () {
      const loggedInUser = sessionStorage.getItem('loggedInUser');
      if (loggedInUser) {
        document.getElementById('main-buttons').classList.add('hidden');
        document.getElementById('welcome').classList.remove('hidden');
        updateWelcomeButtons(); 
      }
    };


    let score = 0;
    let gameTimer;
    
    function startGame() {
      const currentUser = sessionStorage.getItem('loggedInUser');
      if (!currentUser) {
        alert('로그인 후 이용해라!');
        return;
      }
    
      resetGameState();

      const gameArea = createGameArea();
      const countdown = createCountdown(gameArea);
    
      spawnPunch();
      startCountdown(countdown, currentUser);
    }

    function resetGameState() {
      score = 0;
      const existingGameArea = document.getElementById('game-area');
      if (existingGameArea) existingGameArea.remove();
      document.getElementById('welcome').classList.add('hidden');
    }

    function createGameArea() {
      const gameArea = document.createElement('div');
      gameArea.id = 'game-area';
      gameArea.style = 'position:relative; height:400px; background-color:black;';
      document.body.appendChild(gameArea);
      return gameArea;
    }

    function createCountdown(gameArea) {
      const countdown = document.createElement('h2');
      countdown.id = 'countdown';
      countdown.textContent = '10초 준비해라!';
      countdown.style = 'color: white; text-align: center;';
      gameArea.appendChild(countdown);
      return countdown;
    }

    function startCountdown(countdown, currentUser) {
      countdown.style.position = 'absolute';
      countdown.style.top = '10px';
      countdown.style.left = '50%';
      countdown.style.transform = 'translateX(-50%)';

      gameTimer = setInterval(() => {
        const timeLeft = parseInt(countdown.textContent) - 1;
        if (timeLeft > 0) {
          countdown.textContent = `${timeLeft}초 남았다!`;
        } else {
          clearInterval(gameTimer);
          endGame(currentUser);
        }
      }, 1000);
    }


    function spawnPunch() {
      const punch = document.createElement('img');
      punch.src = 'punch.png';
      punch.alt = '주먹';
      punch.style.position = 'absolute';
      punch.style.width = '100px';
      punch.style.height = '90px';
      punch.style.cursor = 'pointer';

      const gameArea = document.getElementById('game-area');
      const gameAreaRect = gameArea.getBoundingClientRect();

      const maxX = gameAreaRect.width - 50;
      const maxY = gameAreaRect.height - 50;

      punch.style.left = `${Math.random() * maxX}px`;
      punch.style.top = `${Math.random() * maxY}px`;

      punch.onclick = () => {
        score++;
        punch.remove();
        spawnPunch();
      };
    
      gameArea.appendChild(punch);
    }


    function endGame(currentUser) {
      clearInterval(gameTimer);
      document.getElementById('game-area').remove();
      alert(`결과: ${score}점!`);
      saveScore(currentUser, score);
      document.getElementById('welcome').classList.remove('hidden');
    }

    function saveScore(username, score) {
      let rankings = JSON.parse(localStorage.getItem('rankings')) || [];
      rankings.push({ username, score, timestamp: Date.now() });
      rankings.sort((a, b) => b.score - a.score || a.timestamp - b.timestamp);
      rankings = rankings.slice(0, 10);
      localStorage.setItem('rankings', JSON.stringify(rankings));
    }

    function showRanking() {
      document.getElementById('welcome').classList.add('hidden');
      const rankingPage = document.createElement('div');
      rankingPage.id = 'ranking-page';
      rankingPage.style = 'text-align:center; color:white; background-color:darkred; padding:20px;';
      document.body.appendChild(rankingPage);
    
      const rankings = JSON.parse(localStorage.getItem('rankings')) || [];
      const rankingList = document.createElement('ul');
      rankingList.style = 'list-style:none; padding:0;';
    
      rankings.forEach((entry, index) => {
        const listItem = document.createElement('li');
        listItem.style = 'margin:10px; font-size:1.2rem; color:yellow;';
        listItem.textContent = `💪🏻${index + 1}등 사나이💪🏻 [${entry.username}: ${entry.score}점]`;
        rankingList.appendChild(listItem);
      });
    
      const backButton = document.createElement('button');
      backButton.textContent = '1보 전진을 위한 2보 후퇴';
      backButton.style = 'margin-top:20px;';
      backButton.onclick = () => {
        rankingPage.remove();
        document.getElementById('welcome').classList.remove('hidden');
      };
    
      rankingPage.appendChild(rankingList);
      rankingPage.appendChild(backButton);
    }


    function startFoodTournament() {
      const foodImages = [
        'food/CPU.png',
        'food/강철.png',
        'food/고추.png',
        'food/김치.png',
        'food/나무껍질.png',
        'food/닭가슴살.png',
        'food/돈까스.png',
        'food/돌맹이.png',
        'food/돼지국밥.png',
        'food/맥주.png',
        'food/메모리.png',
        'food/밥.png',
        'food/번개.png',
        'food/복분자.png',
        'food/부대찌개.png',
        'food/불.png',
        'food/신라면.png',
        'food/삼겹살.png',
        'food/삼계탕.png',
        'food/생고기.png',
        'food/소시지.png',
        'food/순대국.png',
        'food/숯.png',
        'food/아이스아메리카노.png',
        'food/잡초.png',
        'food/장어.png',
        'food/제육.png',
        'food/족발.png',
        'food/치킨.png',
        'food/태양.png',
        'food/핵.png',
        'food/핵불닭볶음면.png',
      ];

      const shuffledFoods = foodImages.sort(() => Math.random() - 0.5); 
      let currentPairs = shuffledFoods.slice();
      let nextRound = [];
      let roundCount = Math.log2(foodImages.length);

      const roundNames = {
        5: '32강',
        4: '16강',
        3: '8강',
        2: '4강',
        1: '결승',
      };
    
      const getFoodName = (filePath) => filePath.split('/').pop().replace('.png', '');
    
      function showFoodPair() {
        const tournamentArea = document.getElementById('food-tournament');
        tournamentArea.classList.add('visible');
        tournamentArea.style.display = 'flex';

        if (currentPairs.length === 0 && nextRound.length === 1) {
          const winnerName = getFoodName(nextRound[0]);
          tournamentArea.innerHTML = `
            <div style="text-align: center;">
              <h2 style="font-size: 2rem;">최고의 상남자 음식:</h2>
              <img src="${nextRound[0]}" alt="Champion" style="width:300px; height:300px; margin:20px;">
              <p style="color:yellow; font-size:2rem; font-weight:bold;">${winnerName}</p>
              <button onclick="closeFoodTournament()" style="margin-top:20px; padding:10px 20px; font-size:1.2rem; background-color:darkred; color:white; border:none; border-radius:5px; cursor:pointer;">닫기</button>
            </div>
          `;
          return;
        }
      
        if (currentPairs.length === 0 && nextRound.length > 1) {
          currentPairs = nextRound;
          nextRound = [];
          roundCount--;
        }
      
        const [food1, food2] = currentPairs.splice(0, 2);
        const food1Name = getFoodName(food1);
        const food2Name = getFoodName(food2);
      
        tournamentArea.innerHTML = `
          <h2 style="font-size: 1.5rem; margin-bottom: 20px;">${roundNames[roundCount]} 대결!</h2>
          <div style="display:flex; justify-content:center; gap:20px;">
            <div style="text-align:center;">
              <img src="${food1}" alt="${food1Name}" style="width:300px; height:300px; margin:10px; cursor:pointer;" onclick="chooseFood('${food1}')">
              <p style="color:white; font-size:1.2rem;">${food1Name}</p>
            </div>
            <div style="text-align:center;">
              <img src="${food2}" alt="${food2Name}" style="width:300px; height:300px; margin:10px; cursor:pointer;" onclick="chooseFood('${food2}')">
              <p style="color:white; font-size:1.2rem;">${food2Name}</p>
            </div>
          </div>
        `;
      }

      window.closeFoodTournament = function () {
        const tournamentArea = document.getElementById('food-tournament');

        tournamentArea.style.display = 'none';
        tournamentArea.classList.remove('visible');
        tournamentArea.innerHTML = ''; 

        const welcomeScreen = document.getElementById('welcome');
        if (welcomeScreen && welcomeScreen.classList.contains('hidden')) {
          welcomeScreen.classList.remove('hidden'); 
        }
      };


      window.chooseFood = function (selectedFood) {
        nextRound.push(selectedFood);
        showFoodPair();
      };
    
      document.getElementById('welcome').classList.add('hidden');
      document.getElementById('food-tournament').classList.remove('hidden');
      showFoodPair();
    }

    let gayTestIndex = 0; 
    const gayTestQuestions = [
      "5층 이하는 창문에서 뛰어내린다",
      "필기할 때에는 돌판에 도끼로 새긴다",
      "코딩할 때 메모리 따위는 신경쓰지 않는다",
      "데이터베이스를 사용하지 않는다",
      "국밥을 먹을 때 덜어먹지 않는다",
      "코딩은 한 손으로 한다",
      "3대 500",
      "휴대폰은 갤럭시다",
      "커피는 무조건 아이스다",
      "남들의 시선 따위 신경쓰지 않는다",
      "브라우저 호환성 따위 신경 쓰지 않는다. 모든 사람이 최신 브라우저를 쓴다",
      "디버깅을 하지 않는다. 코드는 처음부터 완벽하게 한다",
      "상남자는 파일 하나에 모든 코드를 짠다",
      "프레임워크, 라이브러리는 사치다",
      "한번 결정한 선택은 번복하지 않는다",
      "명예와 신의를 지킨다"
    ];
    
    function gayTest() {
      gayTestIndex = 0; 
      document.getElementById("welcome").classList.add("hidden");
      showGayTestQuestion(); 
    }
  
    function showGayTestQuestion() {
      const testArea = document.getElementById("food-tournament");
      testArea.classList.add("visible");
      testArea.style.display = "flex";
      testArea.style.flexDirection = "column";
      testArea.style.alignItems = "center";
      testArea.innerHTML = `
        <div style="text-align: center; width: 100%; max-width: 500px;">
          <h2 style="min-height: 80px; display: flex; align-items: center; justify-content: center;">${gayTestQuestions[gayTestIndex]}</h2>
          <div style="display: flex; justify-content: space-between; margin-top: 20px; width: 100%; max-width: 400px;">
            <button style="flex: 1; margin: 0 10px; padding: 15px 30px; font-size: 1.2rem; background-color: darkred; color: white; border: none; border-radius: 5px; cursor: pointer;" onclick="handleGayTestAnswer('yes')">예</button>
            <button style="flex: 1; margin: 0 10px; padding: 15px 30px; font-size: 1.2rem; background-color: crimson; color: white; border: none; border-radius: 5px; cursor: pointer;" onclick="handleGayTestAnswer('no')">아니오</button>
          </div>
        </div>
      `;
    }
  
    function handleGayTestAnswer(answer) {
      if (answer === "no") {
        endGayTest("하남자");
      } else {
        gayTestIndex++;
        if (gayTestIndex < gayTestQuestions.length) {
          showGayTestQuestion(); 
        } else {
          endGayTest("상남자"); 
        }
      }
    }
  
    function endGayTest(result) {
      const testArea = document.getElementById("food-tournament");
      testArea.innerHTML = `
        <div style="text-align: center;">
          <h2 style="font-size: 2rem; color: yellow;">테스트 결과:</h2>
          <p style="font-size: 1.5rem; color: ${result === "상남자" ? "green" : "red"};">${result}</p>
          <button style="margin-top: 20px; padding: 10px 20px; font-size: 1.2rem; background-color: darkred; color: white; border: none; border-radius: 5px; cursor: pointer;" onclick="closeGayTest()">닫기</button>
        </div>
      `;
    }
  
    function closeGayTest() {
      const testArea = document.getElementById("food-tournament");
      testArea.style.display = "none";
      testArea.classList.remove("visible");
      document.getElementById("welcome").classList.remove("hidden"); 
    }

  </script>
</body>
</html>
